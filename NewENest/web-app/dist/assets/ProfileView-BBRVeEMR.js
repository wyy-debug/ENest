import{u as e}from"./userStore--b81hqFJ.js";import{d as a,r as l,c as t,N as s,j as i,a as u,e as r,w as n,f as d,o,b as c,n as v,p as m,h as p,t as f,F as y,q as _,C as g,E as h}from"./index-DxIqJ1ay.js";import{_ as b}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./index-rSMZb3Ae.js";const V={class:"profile-container"},w={class:"card-header"},k={key:1},D={class:"profile-content"},j={class:"avatar-container"},x={class:"info-container"},I={class:"stats-content"},U={class:"stat-item"},C={class:"stat-value"},P={class:"stat-item"},$={class:"stat-value"},z={class:"stat-item"},M={class:"stat-value"},S={class:"stat-item"},G={class:"stat-value"},N={class:"achievements-content"},O={key:0,class:"achievement-list"},T={class:"achievement-icon"},q={class:"achievement-name"},A=b(a({__name:"ProfileView",setup(a){const b=e(),A=l(!1),B=l(!1),E=l(1800),F=l(45),J=t((()=>{var e;return Math.round((null==(e=b.userInfo)?void 0:e.totalStudyTime)/F.value||0)})),H=l([{id:1,name:"初学者",description:"累计学习时间达到10小时",icon:"el-icon-star-on"},{id:2,name:"坚持不懈",description:"连续学习7天",icon:"el-icon-trophy"},{id:3,name:"专注达人",description:"单次学习时间超过2小时",icon:"el-icon-time"}]),K=t((()=>b.userInfo||{})),L=s({username:"",email:"",avatar:"",signature:"",studyDirection:""});i((async()=>{b.userInfo||await b.getUserInfo(),Object.assign(L,{username:K.value.username||"",email:K.value.email||"",avatar:K.value.avatar||"",signature:K.value.signature||"",studyDirection:K.value.studyDirection||"other"})}));const Q=()=>{A.value=!0},R=()=>{A.value=!1,Object.assign(L,{username:K.value.username||"",email:K.value.email||"",avatar:K.value.avatar||"",signature:K.value.signature||"",studyDirection:K.value.studyDirection||"other"})},W=async()=>{if(!L.username.trim())return void h.warning("用户名不能为空");B.value=!0;const e=await b.updateProfile({username:L.username,signature:L.signature,studyDirection:L.studyDirection});B.value=!1,e.success?(h.success("个人资料更新成功"),A.value=!1):h.error(e.message)},X=e=>{L.avatar=e.url},Y=e=>{const a="image/jpeg"===e.type,l="image/png"===e.type,t=e.size/1024/1024<2;return a||l||h.error("头像只能是 JPG 或 PNG 格式!"),t||h.error("头像大小不能超过 2MB!"),(a||l)&&t},Z=e=>{if(!e)return"0分钟";const a=Math.floor(e/60),l=e%60;return a>0?`${a}小时${l>0?`${l}分钟`:""}`:`${l}分钟`};return(e,a)=>{const l=d("el-button"),t=d("el-avatar"),s=d("el-upload"),i=d("el-input"),h=d("el-form-item"),b=d("el-col"),ee=d("el-row"),ae=d("el-option"),le=d("el-select"),te=d("el-form"),se=d("el-card"),ie=d("el-tooltip"),ue=d("el-empty");return o(),u("div",V,[r(se,{class:"profile-card"},{header:n((()=>[c("div",w,[a[7]||(a[7]=c("h2",null,"个人资料",-1)),A.value?(o(),u("div",k,[r(l,{type:"success",onClick:W,loading:B.value},{default:n((()=>a[5]||(a[5]=[p("保存")]))),_:1},8,["loading"]),r(l,{onClick:R},{default:n((()=>a[6]||(a[6]=[p("取消")]))),_:1})])):(o(),v(l,{key:0,type:"primary",onClick:Q},{default:n((()=>a[4]||(a[4]=[p("编辑资料")]))),_:1}))])])),default:n((()=>[c("div",D,[c("div",j,[r(t,{size:100,src:L.avatar},{default:n((()=>{var e;return[p(f(null==(e=L.username)?void 0:e.charAt(0)),1)]})),_:1},8,["src"]),A.value?(o(),v(s,{key:0,class:"avatar-uploader",action:"/api/upload","show-file-list":!1,"on-success":X,"before-upload":Y},{default:n((()=>[r(l,{size:"small",type:"primary",class:"upload-btn"},{default:n((()=>a[8]||(a[8]=[p("更换头像")]))),_:1})])),_:1})):m("",!0)]),c("div",x,[r(te,{model:L,"label-position":"top",disabled:!A.value},{default:n((()=>[r(ee,{gutter:20},{default:n((()=>[r(b,{span:12},{default:n((()=>[r(h,{label:"用户名"},{default:n((()=>[r(i,{modelValue:L.username,"onUpdate:modelValue":a[0]||(a[0]=e=>L.username=e)},null,8,["modelValue"])])),_:1})])),_:1}),r(b,{span:12},{default:n((()=>[r(h,{label:"邮箱"},{default:n((()=>[r(i,{modelValue:L.email,"onUpdate:modelValue":a[1]||(a[1]=e=>L.email=e),disabled:""},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),r(h,{label:"个性签名"},{default:n((()=>[r(i,{modelValue:L.signature,"onUpdate:modelValue":a[2]||(a[2]=e=>L.signature=e),type:"textarea",rows:"3"},null,8,["modelValue"])])),_:1}),r(h,{label:"学习方向"},{default:n((()=>[r(le,{modelValue:L.studyDirection,"onUpdate:modelValue":a[3]||(a[3]=e=>L.studyDirection=e),style:{width:"100%"}},{default:n((()=>[r(ae,{label:"编程开发",value:"programming"}),r(ae,{label:"人工智能",value:"ai"}),r(ae,{label:"数据科学",value:"data_science"}),r(ae,{label:"语言学习",value:"language"}),r(ae,{label:"数学",value:"math"}),r(ae,{label:"物理",value:"physics"}),r(ae,{label:"艺术",value:"art"}),r(ae,{label:"其他",value:"other"})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","disabled"])])])])),_:1}),r(ee,{gutter:20,class:"stats-row"},{default:n((()=>[r(b,{span:12},{default:n((()=>[r(se,{class:"stats-card"},{header:n((()=>a[9]||(a[9]=[c("div",{class:"card-header"},[c("h3",null,"学习统计")],-1)]))),default:n((()=>[c("div",I,[c("div",U,[a[10]||(a[10]=c("div",{class:"stat-label"},"累计学习时间",-1)),c("div",C,f(Z(K.value.totalStudyTime)),1)]),c("div",P,[a[11]||(a[11]=c("div",{class:"stat-label"},"本周学习时间",-1)),c("div",$,f(Z(E.value)),1)]),c("div",z,[a[12]||(a[12]=c("div",{class:"stat-label"},"平均每日学习",-1)),c("div",M,f(Z(J.value)),1)]),c("div",S,[a[13]||(a[13]=c("div",{class:"stat-label"},"学习天数",-1)),c("div",G,f(F.value)+" 天",1)])])])),_:1})])),_:1}),r(b,{span:12},{default:n((()=>[r(se,{class:"achievement-card"},{header:n((()=>a[14]||(a[14]=[c("div",{class:"card-header"},[c("h3",null,"成就徽章")],-1)]))),default:n((()=>[c("div",N,[H.value.length>0?(o(),u("div",O,[(o(!0),u(y,null,_(H.value,(e=>(o(),u("div",{key:e.id,class:"achievement-item"},[r(ie,{content:e.description,placement:"top"},{default:n((()=>[c("div",T,[c("i",{class:g(e.icon)},null,2)])])),_:2},1032,["content"]),c("div",q,f(e.name),1)])))),128))])):(o(),v(ue,{key:1,description:"暂无成就"}))])])),_:1})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-da55dc25"]]);export{A as default};
