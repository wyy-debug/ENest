import{d as e,r as a,c as l,a as u,o as t,F as o,b as d,e as n,f as s,w as r,g as i,h as m,t as c,u as f,E as p,i as v,j as _,k as h,l as b,m as x,n as g,p as y,q as V,s as w,v as k,x as C,y as j,T as M,z as U}from"./index-DxIqJ1ay.js";import{_ as P}from"./logo-vD0ayxQ_.js";import{u as R}from"./userStore--b81hqFJ.js";import{u as S}from"./studyRoomStore-DErwerc7.js";import{_ as $}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./index-rSMZb3Ae.js";const I={class:"header-container"},N={class:"logo-container"},q={class:"search-container"},E={class:"action-container"},L={class:"user-dropdown"},z={class:"dialog-footer"},F=$(e({__name:"HeaderComponent",setup(e){const v=f(),_=R(),h=S(),b=a(""),x=a(!1),g=a(!1),y=l((()=>_.userInfo)),V=a({name:"",description:"",maxMembers:20,isPrivate:!1,theme:"default"}),w=()=>{b.value.trim()&&v.push({name:"Home",query:{search:b.value}})},k=()=>{x.value=!0},C=async()=>{if(!V.value.name.trim())return void p.warning("自习室名称不能为空");g.value=!0;const e=await h.createRoom({name:V.value.name,description:V.value.description,maxMembers:V.value.maxMembers,isPrivate:V.value.isPrivate,theme:V.value.theme});g.value=!1,e.success?(p.success("自习室创建成功"),x.value=!1,v.push({name:"StudyRoom",params:{id:e.data.id}})):p.error(e.message)},j=()=>{v.push({name:"Profile"})},M=()=>{v.push({name:"Friends"})},U=()=>{v.push({name:"Dashboard"})},$=()=>{_.logout(),v.push({name:"Login"}),p.success("已成功退出登录")};return(e,a)=>{const l=s("router-link"),f=s("el-input"),p=s("el-button"),v=s("el-avatar"),_=s("el-dropdown-item"),h=s("el-dropdown-menu"),R=s("el-dropdown"),S=s("el-form-item"),F=s("el-input-number"),H=s("el-radio"),A=s("el-radio-group"),D=s("el-option"),K=s("el-select"),T=s("el-form"),B=s("el-dialog");return t(),u(o,null,[d("div",I,[d("div",N,[n(l,{to:"/"},{default:r((()=>a[8]||(a[8]=[d("img",{src:P,alt:"NewENest Logo",class:"logo"},null,-1),d("span",{class:"logo-text"},"NewENest",-1)]))),_:1})]),d("div",q,[n(f,{modelValue:b.value,"onUpdate:modelValue":a[0]||(a[0]=e=>b.value=e),placeholder:"搜索自习室...","prefix-icon":"el-icon-search",clearable:"",onKeyup:i(w,["enter"])},null,8,["modelValue"])]),d("div",E,[n(p,{type:"primary",onClick:k},{default:r((()=>a[9]||(a[9]=[m("创建自习室")]))),_:1}),n(R,{trigger:"click"},{dropdown:r((()=>[n(h,null,{default:r((()=>[n(_,{onClick:j},{default:r((()=>a[10]||(a[10]=[m("个人中心")]))),_:1}),n(_,{onClick:M},{default:r((()=>a[11]||(a[11]=[m("好友列表")]))),_:1}),n(_,{onClick:U},{default:r((()=>a[12]||(a[12]=[m("学习数据")]))),_:1}),n(_,{divided:"",onClick:$},{default:r((()=>a[13]||(a[13]=[m("退出登录")]))),_:1})])),_:1})])),default:r((()=>{var e;return[d("div",L,[n(v,{src:null==(e=y.value)?void 0:e.avatar,size:32},{default:r((()=>{var e,a;return[m(c(null==(a=null==(e=y.value)?void 0:e.username)?void 0:a.charAt(0)),1)]})),_:1},8,["src"])])]})),_:1})])]),n(B,{modelValue:x.value,"onUpdate:modelValue":a[7]||(a[7]=e=>x.value=e),title:"创建自习室",width:"500px"},{footer:r((()=>[d("span",z,[n(p,{onClick:a[6]||(a[6]=e=>x.value=!1)},{default:r((()=>a[16]||(a[16]=[m("取消")]))),_:1}),n(p,{type:"primary",onClick:C,loading:g.value},{default:r((()=>a[17]||(a[17]=[m("创建")]))),_:1},8,["loading"])])])),default:r((()=>[n(T,{model:V.value,"label-width":"80px"},{default:r((()=>[n(S,{label:"房间名称",required:""},{default:r((()=>[n(f,{modelValue:V.value.name,"onUpdate:modelValue":a[1]||(a[1]=e=>V.value.name=e),placeholder:"请输入自习室名称"},null,8,["modelValue"])])),_:1}),n(S,{label:"房间描述"},{default:r((()=>[n(f,{modelValue:V.value.description,"onUpdate:modelValue":a[2]||(a[2]=e=>V.value.description=e),type:"textarea",placeholder:"请输入自习室描述"},null,8,["modelValue"])])),_:1}),n(S,{label:"最大人数"},{default:r((()=>[n(F,{modelValue:V.value.maxMembers,"onUpdate:modelValue":a[3]||(a[3]=e=>V.value.maxMembers=e),min:1,max:50},null,8,["modelValue"])])),_:1}),n(S,{label:"访问权限"},{default:r((()=>[n(A,{modelValue:V.value.isPrivate,"onUpdate:modelValue":a[4]||(a[4]=e=>V.value.isPrivate=e)},{default:r((()=>[n(H,{label:!1},{default:r((()=>a[14]||(a[14]=[m("公开")]))),_:1}),n(H,{label:!0},{default:r((()=>a[15]||(a[15]=[m("私有")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),n(S,{label:"房间主题"},{default:r((()=>[n(K,{modelValue:V.value.theme,"onUpdate:modelValue":a[5]||(a[5]=e=>V.value.theme=e),placeholder:"请选择主题"},{default:r((()=>[n(D,{label:"默认",value:"default"}),n(D,{label:"专注",value:"focus"}),n(D,{label:"森林",value:"forest"}),n(D,{label:"海洋",value:"ocean"}),n(D,{label:"咖啡厅",value:"cafe"})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-417725b2"]]),H={class:"sidebar-footer"},A={class:"study-stats"},D=$(e({__name:"SidebarComponent",setup(e){const i=v();f();const M=S(),U=a(120),P=a(720),R=l((()=>i.path)),$=l((()=>M.myRooms||[]));_((async()=>{try{await M.fetchRooms()}catch(e){p.error("获取自习室列表失败")}}));const I=()=>{p.info("请使用顶部的创建自习室按钮")},N=e=>{const a=Math.floor(e/60),l=e%60;return a>0?`${a}小时${l>0?`${l}分钟`:""}`:`${l}分钟`};return(e,a)=>{const l=s("el-icon"),i=s("el-menu-item"),f=s("el-divider"),p=s("el-sub-menu"),v=s("el-menu");return t(),u(o,null,[n(v,{"default-active":R.value,class:"sidebar-menu",router:""},{default:r((()=>[n(i,{index:"/"},{default:r((()=>[n(l,null,{default:r((()=>[n(h(b))])),_:1}),a[0]||(a[0]=d("span",null,"首页",-1))])),_:1}),n(i,{index:"/dashboard"},{default:r((()=>[n(l,null,{default:r((()=>[n(h(x))])),_:1}),a[1]||(a[1]=d("span",null,"学习数据",-1))])),_:1}),n(p,{index:"study-rooms"},{title:r((()=>[n(l,null,{default:r((()=>[n(h(k))])),_:1}),a[2]||(a[2]=d("span",null,"我的自习室",-1))])),default:r((()=>[(t(!0),u(o,null,V($.value,(e=>(t(),g(i,{key:e.id,index:`/study-room/${e.id}`},{default:r((()=>[m(c(e.name),1)])),_:2},1032,["index"])))),128)),0===$.value.length?(t(),g(i,{key:0,disabled:""},{default:r((()=>a[3]||(a[3]=[m(" 暂无自习室 ")]))),_:1})):y("",!0),n(f),n(i,{onClick:I},{default:r((()=>[n(l,null,{default:r((()=>[n(h(w))])),_:1}),a[4]||(a[4]=d("span",null,"创建自习室",-1))])),_:1})])),_:1}),n(i,{index:"/friends"},{default:r((()=>[n(l,null,{default:r((()=>[n(h(C))])),_:1}),a[5]||(a[5]=d("span",null,"好友列表",-1))])),_:1}),n(i,{index:"/profile"},{default:r((()=>[n(l,null,{default:r((()=>[n(h(j))])),_:1}),a[6]||(a[6]=d("span",null,"个人设置",-1))])),_:1})])),_:1},8,["default-active"]),d("div",H,[d("div",A,[d("p",null,"今日学习: "+c(N(U.value)),1),d("p",null,"本周学习: "+c(N(P.value)),1)])])],64)}}}),[["__scopeId","data-v-4a32fe37"]]),K={class:"main-layout"},T=$(e({__name:"MainLayout",setup(e){const a=v(),o=l((()=>"StudyRoom"!==a.name));return(e,a)=>{const l=s("el-header"),d=s("el-aside"),i=s("router-view"),m=s("el-main"),c=s("el-container");return t(),u("div",K,[n(c,null,{default:r((()=>[n(l,{height:"60px"},{default:r((()=>[n(F)])),_:1}),n(c,null,{default:r((()=>[o.value?(t(),g(d,{key:0,width:"240px"},{default:r((()=>[n(D)])),_:1})):y("",!0),n(m,null,{default:r((()=>[n(i,null,{default:r((({Component:e})=>[n(M,{name:"page"},{default:r((()=>[(t(),g(U(e)))])),_:2},1024)])),_:1})])),_:1})])),_:1})])),_:1})])}}}),[["__scopeId","data-v-acfe2fc2"]]);export{T as default};
